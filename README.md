# CMS ROMs

This project contains data downloaded from the Read Only Memory (ROM) of a 
Creative Micro Systems (CMS) 9619 Advanced Single Board Computer (SBC) and a 
CMS 6909 MPU module.

The initial data is in the Apple II System Monitor memory dump format (.mondmp). 
However, they are easily changed to other more standard formats using the scripts contained in the makefile. 

## Background

The CMS 9619 and 9609 computers are EXORBus compatible, have MC6809 processors 
and a number of PIAs and ACIAs, making them fairly capable SBCs. 
The ROMS appear to be versions of the MICROWARE SYSTEMS CORPORATION DEBUG 
machine monitor. [The source code of an earlier version of it](http://www.retro.co.za/6809/documents/debug09.pdf) 
is available online. The sections with similar functions have comments straight from that document. 
The [debugger in Nitros-9](https://github.com/boisy/nitros9/blob/master/level1/cmds/debug.asm) contains similar code. 
There also appears to be user code in U17_9619 that I have not looked at yet.

My workflow for ripping EPROMS and programming new EEPROMS uses an Apple II and a 
Super Serial card, so some of the file formats revolve around the Apple II System Monitor.
However, several of the formats are generic enough to use with standard EEPROM burners.


## Prerequisites

The makefile uses:
* sed, xxd - to convert from the Apple II monitor format to hex, binary, or hexdump format.

* [f9dasm](https://github.com/Arakula/f9dasm) - to disassemble the binary, and incorporate the comments.

* lwasm from [LWTools](https://github.com/milliluk/LWTools) - to assemble the source files back to binaries.

* [c2t](https://github.com/datajerk/c2t) - to create cassete input audio file for transferring data back to the Apple II.

* diff - to compare the original binary hexdump to the compiled binary hexdump.

However, you only need sed and xxd to convert to simpler formats.


## Makefile Commands

The included makefile includes a number of commands to do the various file 
conversions. Basically, the make target should be specified as the base filename
 you want to convert, with the new extension for the file type you want. 
Supported extensions are:

.mondump: Apple II System Monitor memory dump format. ("-" separates address from values)

.mon: Apple II System Monitor memory change format. (":" separates address from values)

.aif: Apple II cassette input audio format.

.bin: binary format, generated from a mon file.

.hex: standard xxd/hexdump format of a bin.

.info: [f9dasm info file format](https://htmlpreview.github.io/?https://raw.githubusercontent.com/Arakula/f9dasm/master/f9dasm.htm)
to add comments to asm files.

.asm: 6809 assembly format with comments from an info file.

.raw: binary format, generated by lwasm from asm file.

.diff: diff output comparing the mon file to the disassembled, then reassembled, then hex'ed (in mon format) file.

For example, the command:

`make U7_9619.asm`

will convert the U7_9619.mondmp file to a more standard format, then convert it to a binary, then disassemble it using f9dasm.

The command:

`make U7_9619.diff`

does the same as above, then assembles the the .asm file using lwtools, then generates a hexdump of the re-assembled binary. Finally, it compares the original binary hexdump to the re-assembled binary hexdump.

The command:

`make all`

will convert all of the mon files, disassemble them, and combine them into final EPROM_9619.asm and EPROM_9609.asm files for each model number.

Use:

`make fix`

to change the reset vector of the U7_9619.mon file to point to the debugger init, and generate 
a U7_9619_fix.mondmp file with the fix. 
This file can be further processed by the makefile, for instance:

`make U7_9619_fix.mon`

or 

`make U7_9619_fix.aif`

to generate an Apple II monitor input file or cassete input audio file to upload back to the 
Apple II for EEPROM programming.

## TO DO

The disassembly comments are not complete yet. It is a work in progress, but still helpful to see what the monitors do.
